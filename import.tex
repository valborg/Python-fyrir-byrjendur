\chapterimage{chapters11.png} % Chapter heading image

\chapter{Kóðasöfn}\index{Kóðasöfn}\label{k:import}
Kóðasafn (e. library)\footnote{Hugtökin package og module ná einnig yfir kóðasöfn í Python vegna þess hve lauslega kóðasöfn eru skilgreind} er endurnýtanlegur kóði, sem sem útfærir ákveðna virkni og hefur ákveðið samhengi.
Tilgangur þeirra er að spara forriturum vinnu við að útfæra ýmsa algenga virkni og reiða sig í staðinn á kóða sem er nú þegar til.
Hjálpar okkur við að vera ekki að finna upp hjólið í sífellu.
Ómögulegt er að ætla að forrita að einhverju viti án þess að nota kóðasöfn.

Við notum kóðasöfn með \textbf{import} skipuninni. 
Þegar import hefur verið sett inn einhvers staðar í skjal þá er óþarfi að setja það inn aftur, venjan er að öll import eru gerð efst í skjali burt séð frá því hvar í skjalinu þau eru notuð.
Það gerir kóðann læsilegri og undirbýr okkur við lestur á kóða hvað er að fara að gerast.
Sem dæmi ef efst í skjali stendur að kóðasöfnin math og random séu notuð þá vitum við strax að í þessum kóða sé líklega verið að vinna með einhverja handahófskennd og stærðfræði, en ef efst stæði að kóðasöfnin datetime og time væru notuð þá erum við líklega að skoða kóða sem er að vinna með tíma og dagsetningar, það ætti þá ekki að koma okkur á óvart að sjá dagsetningarvinnslu.

Venjan að setja öll ,,import'' efst er því gagnleg fyrir þær sakir að kóðinn verður læsilegur og auðveldara verður að halda utan um kóðasöfnin sem við erum að nota.

\section{Notkun kóðasafna}\index{Tilgangur kóðasafna}\label{uk:kóðasöfn-kynnt}
Eins og kom fram í kynningu þá viljum við geta einbeitt okkur að því að leysa okkar vandamál í stað þess að finna upp hjólið og því viljum við kynna okkur þau kóðasöfn sem eru í boði sem útfæra virkni sem við viljum beita.

Tilgangur þeirra er að létta okkur lífið og gera virkni aðgengilega.
Í næsta undirkafla verða tekin fyrir nokkur gagnleg kóðasöfn en við getum varla talað um tilgang og gagnsemi kóðasafna án þess að taka eitthvert þeirra fyrir.
Í inngangi voru kóðasöfnin time og random nefnd.
Skoðum þau aðeins núna, sjá kóðabúta \ref{lst:kóðasöfn-kynnt-time} og \ref{lst:kóðasöfn-kynnt-rand} þar sem kóðasöfnin \texttt{time} og \texttt{random} eru tekin fyrir.
Þau bjóða bæði upp á aragrúa aðferða og eiginda sem er út fyrir efni þessarar bókar að ræða í þaula en þó þess virði að taka fyrir ákveðna virkni sem búist er við að nota í æfingum í lok kaflans.
\paragraph{}
Um kóðasafnið time:

\begin{itemize}
	\item \texttt{time.time()} skilar okkur hversu margar sekúndur eru síðan tímatal í tölvum hófst 1.jan 1970.
	\item \texttt{time.sleep()} tekur við tölu og lætur vélina bíða það margar sekúndur áður en hún framkvæmdir aðgerðina í næstu línu fyrir neðan.
	\item \texttt{time.localtime()} skilar okkur nd sem inniheldur í minnkandi röð hver tíminn er, frá ári niður í sekúndur, ásamt deginum í vikunni og árinu og síðasta er gildi sem tekur mið af \texttt{isdaylightsavingstime} (\textbf{isdst}).
\end{itemize}

\paragraph{}
Um kóðasafnið random:Þetta kóðasafn gerir forriturum auðveldara fyrir með því að gera handahófskennd (e. randomness) aðgengilega, það að geta gert hluti af handahófi er mjög mikilvægt í tölvunarfræði og forritun.

\begin{itemize}
	\item random.randint() nær í heiltölu á lokuðu bili, þar sem báðir endapunktar eru teknir með.
	\item random.random() nær í fleytitölu á bilinu 0 - 1
	\item random.choice() nær í stak af handahófi upp úr ítranlegum hlut
	\item random.shuffle() stokkar upp í raðanlegum hlut.
\end{itemize}
\vspace{1cm}
\begin{lstlisting}[caption=Notkun kóðasafna með time, label=lst:kóðasöfn-kynnt-time]
import time

sekundur_adan = time.time()
time.sleep(3)
sekundur_3_sek_eftir_adan = time.time()

thrir = sekundur_3_sek_eftir_adan - sekundur_adan
print(thrir)
\end{lstlisting}
\lstset{style=uttak}
\begin{lstlisting}
3.001107931137085
\end{lstlisting}
\lstset{style=venjulegt}
\vspace{1cm}
Þið fáið ekki nákvæmlega sömu tölu, og ekki einu sinni ef þið reynið að keyra þetta oft, það er líka ómögulegt að ná keyrslu upp á millisekúndu-nákvæmni með þessu móti.

Skoðum næst handahófskennd.

\phantom{easter egg}
%\begin{wrapfigure}{i}{0.2\textwidth} %i o r l 
\begin{center}
	\includegraphics[scale=1.9]{doooodles_valborg-02.png}
\end{center}
%\end{wrapfigure}
\phantom{}

\begin{lstlisting}[caption=Notkun kóðasafna með random, label=lst:kóðasöfn-kynnt-rand]
import random

listi = [1,2,3,4,5,6,7,8,9]
einhver_tala = random.choice(listi)
random.shuffle(listi)
print(listi)
for i in range(einhver_tala):
	if random.randint(min(listi),max(listi)) > i:
		print("Þú vannst 10kr")
	else:
		print("Þú þarft að ydda blýantana þína")

fjoldi_folks = 100
hlutfall_folks_med_raudan_trefil = fjoldi_folks*random.random()
print(hlutfall_folks_med_raudan_trefil)
\end{lstlisting}
\lstset{style=uttak}
\begin{lstlisting}
[9, 3, 2, 7, 5, 1, 4, 8, 6]
Þú vannst 10kr
Þú vannst 10kr
Þú vannst 10kr
Þú vannst 10kr
Þú þarft að ydda blýantana þína
Þú þarft að ydda blýantana þína
Þú þarft að ydda blýantana þína
Þú þarft að ydda blýantana þína
98.19660121258345 %
\end{lstlisting}
\lstset{style=venjulegt}

Sama upp á teningnum hér, úttakið verður ekki það sama þegar þið keyrið þennan kóða en ekki af sömu ástæðu.
Hér er það beinlínis ætlunarverkið að úttakið verði óútreiknanlegt.



Eins og sést í kóðabút \ref{lst:kóðasöfn-kynnt-time} þarf að nota nafnið á kóðasafninu til að ná í aðferðir og virkni.
Sum kóðasöfn heita löngum nöfnum og ef fólk vill stytta nöfnin á þeim þá má nota lykilorðið \textbf{as} til þess að varpa nafninu á kóðasafninu í annað breytuheiti, sjá notkun í kóðabút \ref{lst:kóðasöfn-as}.
Vísunin kemur strax þegar kóðasafnið er flutt inn og þar eftir er kóðasafnið aðgengilegt með þessari vísun.
Mikilvægt er þá að hafa í huga að nefna kóðasöfnin eittvað sem verður ekki óvart yfirskrifað í kóðanum, og gæti valdið ruglingi.
Eins og að skipta út \texttt{import random} fyrir \texttt{import random as listinn\_minn}.
Það væri hrikalegt, illlæsilegt og myndi fyrirsjánlega valda vandamálum.
En nú vitum við hvernig á að nota kóðasöfn.

\begin{lstlisting}[caption=Lykilorði as, label=lst:kóðasöfn-as]
import random as rnd
import time as t

timi = t.time() 
tala = rnd.random()
print(timi * tala % tala)
\end{lstlisting}
\lstset{style=uttak}
\begin{lstlisting}
0.4772097503672992
\end{lstlisting}
\lstset{style=venjulegt}

\section{Nokkur gagnleg kóðasöfn}\index{Nokkur gagnleg kóðasöfn}\label{uk:kóðasöfn-gagnleg}
Tilgangur þessarar bókar er ekki að tiltaka hvert einasta kóðasafn sem er til, heldur að kynna til sögunnar hvernig notkun þeirra virkar og einhver þau algengustu eða skemmtilegustu kóðasöfn sem eru notuð í dag.
Þetta er gert til þess að halda bókinni frá því að verða eins og símaskrá (ef einhver lesandi man eftir að hafa haldið á símaskrá) og passa að hún haldi í við þróun í fræðigreininni.

Að því sögðu er hér stutt kynning á nokkrum vinsælum kóðasöfnum.

\begin{itemize}
	\item \textbf{math}, þetta kóðasafn gerir aðgengilegar allskonar stærðfræðilegar aðgerðir.
	Eins og hornaföll, logra, veldisföll og tölulega vinnslu.
	Ásamt því að gefa okkur aðgengi að mikilli nákvæmni á hinum ýmsu rauntölustærðum eins og pí.
	\item \textbf{numpy}, er kóðasafn sem gerir stærðfræðilega vinnslu aðgengilega, t.d. á fylkjum.
	Numpy er sérhæft fyrir flóknari vinnslu en math.
	\item \textbf{scipy}, er það sem hægt er að nota til þess að vinna með vélanám (e. machine learning).
	Scipy hefur oft verið kallað óþarflega flókið í notkun, en hugmyndirnar sem þar er verið að vinna með eru í grunninn mun flóknari en í numpy og math pökkunum svo það ætti ekki að koma á óvart.
	\item \textbf{pygame}, er kóðasafn sem vinnur með grafískt viðmót og inntak frá notanda oft með mjög skapandi útkomu.
	Margir litlir leikir hafa orðið til með þessu kóðasafni og er til mýgrútur af dæmum og leikjum á netinu til að vinna út frá.
	\item \textbf{datetime}, sem vinnur með dagsetingar því ef við ætlum einhvern tímann að skrifa hugbúnað sem vinnur með dagsetningar þá viljum við alls ekki finna upp hjólið.
	Þar er tekið á daylightsavings, hlaupárum og öðru slíku sem við viljum ekki þurfa að hafa áhyggjur af
	\item \textbf{matplotlib}, er safn sem var búið til í kringum tvívíða sýn á gögn.
	Til að sýna gröf og á fjölbreytilegan máta gera gögn sýnileg.
	Þetta er annað safn sem hefur slæmt orð á sér fyrir að vera óþarflega óaðgengilegt.
\end{itemize}

Að búa til kóðasöfn er út fyrir efni bókarinnar en það er lítið mál að kynna sér það á vefnum.

%-------------------------------
\newpage
\section{Æfingar}

\begin{exercise}\label{imp1}
Notið input skipun til þess að komast að því hvort að notandinn viti hversu lengi 10 sekúndur eru að líða. 
\end{exercise}
\setboolean{firstanswerofthechapter}{true}
\begin{Answer}[ref={imp1}]
input skipunin er í rauninni bara þarna í staðinn fyrir time.sleep(), núna er það notandinn sem ákveður hvenær næsta lína af kóða er keyrð.
Það sem við þurfum að fatta er að reikna rétt út og finna tímann.
	\begin{lstlisting}
adan = time.time()
input("ýttu eftir 10 sek")
nuna = time.time()
print(nuna-adan)\end{lstlisting}
\end{Answer}
\setboolean{firstanswerofthechapter}{false}


\begin{exercise}\label{imp2}
Gefinn er eftirfarandi listi: 
['Lorem','ipsum','dolor','sit','amet,','consectetur',
'adipiscing','elit,','sed','do','eiusmod','tempor',
'incididunt','ut','labore','et','dolore','magna','aliqua.',
'Ut','enim','ad','mini','veniam,','quis','nostrud',
'exercitation','ullamco','laboris','nisi','ut','aliquip',
'ex','e','commodo','consequat.','Duis','aute','irure',
'dolor','in','reprehenderit','in','voluptate','velit',
'esse','cillum','dolore','eu','fugiat','nulla','pariatur.',
'Excepteur','sint','occaect','cupidatat','non','proident,',
'sunt','in','culpa','qui','officia','deserunt','mollit',
'ani','id','est','laborum.']

Náið í orð af handahófi úr listanum og náið svo í tákn af handahófi úr því orði.
\end{exercise}
\begin{Answer}[ref={imp2}]
Hér þurfum við aðallega að átta okkur á því hvaða föll við viljum nota úr random pakkanum, úr listanum viljum við nota choice en til að finna eitthvað tákn viljum nota randint.
Athugum hér að þegar við notum randint þá gefum við upp bil af tölum eins og 1,10 þá eru bæði 1 og 10 með, svo þegar við notum það til að búa til sætisvísi af handahófi verðum við að passa að fara ekki út fyrir löglega sætisvísa.
	\begin{lstlisting}
rugl_ord = random.choice(listi)
rugl_takn = rugl_ord[random.randint(0,len(rugl_ord)-1)]
print(rugl_ord, rugl_takn)\end{lstlisting}
\end{Answer}